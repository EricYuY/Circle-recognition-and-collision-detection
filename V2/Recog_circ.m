function [Y,Xf,Af] = Recog_circ(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 25-Jun-2021 20:57:06.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 40xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.0103092783505155;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0.01];
x1_step1.gain = [4.08421052631579;11;10.6;9;8;5.5;9;8;10;9.33333333333333;10.6666666666667;8.66666666666667;11;9;9;10;9.71428571428572;8;10;6;10;8.5;12.6666666666667;10;8.30769230769231;7.69230769230769;8.92307692307692;9.81818181818182;6;8;9;8.66666666666667;10;8.85714285714286;9.63636363636364;8.83333333333333;10.8333333333333;8.72727272727273;9.6;5.12820512820513];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.5090046650759008084;1.3054441609308624628;-1.1376703231990861198;1.1217584920988510344;-0.86574849893100547238;-0.6801426173467676195;-0.5161563102346908849;0.51737632383823406457;0.26884230341057985259;0.02135717619309339052;-0.098995050171340623346;-0.24390437516323168476;0.39147166353387202742;0.62079510519276048797;0.79299983318320010905;-0.86410879151081609884;-0.99497890575964031967;-1.1614187123298709281;1.3280798305685010963;1.5623357732549336685];
IW1_1 = [0.16844350266464191979 0.15427678874714639834 -0.094799346276774415498 0.015326231445040007506 0.42839388702808567366 0.35302538030000085723 0.3657293532192001928 -0.012994122684619812541 -0.13234250560119489859 0.18013295501938730858 0.38479833624202974818 0.031638930784372402971 0.051702039297448265653 0.017531078034578689157 0.0052893009235708797477 0.088657205089089002881 -0.29283938894642774775 0.2073228847512200157 0.27310540715080899865 -0.43162126753592683359 0.29647977243254769464 -0.33173768686755578106 0.074857547839191837524 0.12916048120906326035 -0.33018827324865346329 -0.15334445675539604137 0.065473653959795707902 0.055223184842508793446 0.42284652021199353733 -0.038620596416100716475 0.38630892753427553687 -0.27654841737613333752 0.031805057449136218961 0.21951043364981479011 0.32767051878182956726 0.2546665510734579807 -0.25482464257270692753 0.14702253654858629672 -0.082442429569047459559 0.30530705981932293458;-0.78083869960095209084 -0.24338000427031483697 -0.058087523116896438991 -0.066502014585744159691 -0.25550696670948486178 -0.3801310261407931379 0.41710247997630800487 0.15122918208887764502 -0.058189824523329519712 0.10115180762067237097 0.38873660454403485831 -0.25589323018131154841 0.39252240265704402278 -0.075855161227121700729 0.28693259439714124959 -0.20001773200326697366 0.20795295100565922009 -0.22181622020835645159 0.41224936917358973032 0.12741513648818267312 0.014485111035982555644 -0.026157596832855976865 0.20984976640528324454 -0.079076428007813892584 0.26324560887244624618 0.00051929258075409517881 -0.023839265870898747324 -0.23092848577911262442 0.053554802114743393915 0.25428512559535770832 0.13496349867888851604 0.22450424204343316648 0.22349526321679991092 -0.012495778436831007918 0.0095756956928274988838 -0.086033012130562414033 0.4449412272033240745 0.6476460411279232332 0.36097509487211726364 -0.34476639142408516125;0.41882756325992132052 -0.12596856987236476622 -0.11906068078915155173 0.070728679527803567373 -0.37838823074702726545 0.082098867974415234983 0.31541531721597976246 0.25688040239978737755 0.10594959403170405021 -0.057773275676870718132 0.39117718978588073009 -0.02153002758545916398 -0.06272286206557434185 0.27646057000678403437 0.066518628142745922505 -0.015476341250966477864 -0.36786829745569227246 0.1646195920119912226 -0.18000220706016145655 0.39019778803385796184 -0.54082106813515962163 -0.3003024491693070952 0.34689827065690131969 0.033938465081751557906 0.035776226937827171337 0.15526482632748206392 -0.16458583566085160932 -0.25071745768941933186 -0.17229628974795779817 -0.36939650273016788606 -0.34527251525023400225 0.25458160573042543096 0.085118800444405437466 -0.34203381899752405282 -0.1299452888673783002 0.13006422520416169308 -0.08001257233408570757 -0.0023124862294872164381 -0.38393998970029008522 -0.02006125870015531068;-0.23790970267370906144 -0.34748424856450987885 -0.28958427887082655028 -0.096190206784998330547 -0.42129699723852187532 -0.13090917979374414037 -0.22320887013941684285 -0.090064450128778200666 -0.18505950625545208865 -0.088036182991325262481 0.095066256533416035324 -0.4695961362143806217 0.10725186585193537125 0.20580973402597377286 0.19113432139955530142 -0.028760060507571991867 0.29384838786739059247 0.14508411038549967609 -0.013329013948182231314 0.33667547193069596867 -0.27335276726572937944 0.28334482088222789908 0.14387065764512349531 -0.2232109651901655889 -0.13376398223854701897 -0.45147150135644809055 -0.039833092890276533549 -0.21917526389817168497 0.13657166709131890459 -0.35406371435445938012 -0.24155122795365652211 -0.40922724073009641987 -0.19103345218824616114 0.046286263131813887295 0.1391615632550382009 0.26886428738492396118 0.1910585069859535301 -0.024786498023338092433 -0.43684550977034902752 -0.25162635320094678404;-0.26985312815196998981 -0.63709986380658967242 -0.32514612441318291314 -0.17712732518672727466 -0.055559214695933140105 -0.30726177778922908468 -0.1734527863644592105 -0.43583815928433589093 -0.15660272508186795504 0.15616244045878602265 0.36031918321395567384 0.18385554734980130709 0.1037014263537022335 -0.26945060776849172335 0.35535459972209865187 0.34853910035998530992 0.29662483435185038605 0.36153815945312983704 -0.48200283646309655117 -0.10388417259727479591 0.14639769331918595086 -0.16393751729239192105 0.20008480485262014614 -0.16513007237921237258 0.36496402708823888483 0.38958489821719088919 0.26097304482441557871 0.51803972868883274572 -0.030620860735531555546 0.14482686234991107299 -0.20864904670331280157 -0.2459866101754683565 -0.043246954358025682663 0.24862206219665033968 -0.10795993942541573518 0.58145997116722236697 0.36707104957035951998 -0.19978538700073256162 0.1773429197992792139 -0.3741629956905619947;0.2822281771727336297 -0.20033802001297199014 -0.40095826395836353662 -0.15735490182459554998 -0.3680357558096258308 0.41570830062851582554 -0.49281959008030318259 0.095303059544317225704 0.17471370838287830773 0.21432804637228769495 0.29116981595351604239 0.096997022023120549328 0.062362971998367745796 0.29689212543775073128 0.22077247800844027048 -0.31399001374411883436 -0.23168490794195756299 -0.078137580981874593666 -0.19619978814015281987 0.13823279225234066936 0.024512669517877158643 0.0010736072404481534354 0.22812464466094090065 -0.36612668590416180825 0.1730514939305736466 0.21100599678817988369 0.25967965800484443806 -0.29253442528131329281 0.12932990795789836569 -0.12494518688329406264 -0.28759596725788894034 0.044620074407514719039 0.16171525483664572764 0.19709545362691677228 -0.45423704798032621399 -0.29706076611601062165 0.27552208274078177075 -0.017961614446136975332 -0.60369631865375050772 0.37499238181224386901;-0.3032860961325195559 0.29457772731690795576 0.096467471127778647855 -0.40510889124518001392 0.1403509342677496663 0.083392295992905485225 0.16050296144554793143 -0.14987117419443449218 0.0056559983388050540792 -0.021300594955065414726 0.20204083469380049176 -0.13033753827477051468 -0.10455527163472980168 -0.36416881120598820765 0.077108752311440792448 0.038653612215565014143 0.0019802800756991345218 -0.33473079078275369547 0.23608837364294890659 -0.23203083230699644846 -0.094742071433962432581 -0.31176502999964811336 0.04487999451017136987 -0.46613571171938023019 -0.17517555351043462286 -0.17005251165215937159 0.41763420521956728937 0.3956851392559954661 -0.18446757902761082293 -0.21106696638840291569 0.36788031758582234731 -0.32143199182478737752 0.28621814483763785564 0.013383792182244599878 0.56372594700737976847 -0.026490431024047616376 0.22688088848735449288 0.48779677109116192923 0.65579579942362231648 -0.58554543179380169615;-0.061822905559529739428 0.14753463834185037706 -0.152458361532309572 -0.41795977442352799658 -0.39197281124068550362 -0.052816990906657569627 0.21970794379109889749 -0.34873026238249815734 -0.34427874036007594105 -0.32573955488319705776 -0.1234634522036983928 0.14151799237970405509 -0.12541218580102284075 -0.051371242825607954519 0.18218608279315737231 -0.4517381621939243197 0.077143645537061988904 0.019031031299715131522 -0.0036260675177036509609 0.19916251561782097323 -0.36685709203740124451 0.26769640186178217389 -0.14566496053523114718 -0.15671919008013371344 -0.2660302827563766348 0.099406684411026124959 0.20269562254295700465 -0.26442294115654763065 0.24144785500679197265 -0.29898262560293570322 0.24029081262849141809 -0.059871687390255022565 0.23953417057641893106 -0.32648297369656004152 -0.38607554601914140235 -0.071082574496082837068 -0.15897101384473696917 -0.57274527686199550036 0.02546623613048826229 0.0816673316525327736;-0.17993488081334083062 0.31504200867550968823 -0.29678374954020653176 0.33456534945514260215 -0.2539805461143123666 0.24852913830889453162 0.14817855934030044196 -0.18048059810990113583 0.22891011654542828269 -0.034148752503646281897 0.036968638803937081683 0.0787425074247365131 -0.43610204637856697651 -0.33627790887708636225 -0.49006913560214132586 0.22864102748423306699 0.24935593669944611239 -0.28201141301753035462 0.053495669058174509514 0.26361934394705227591 -0.29510255663263129655 -0.035977788882989233943 -0.3955644040215638424 0.40110089636269380398 0.04101321278041013263 0.19941639398913141301 0.014504512058494459931 -0.43457562466484883634 -0.0034888500371745602424 0.19872924651171625099 -0.047014358045622157978 -0.084832444891866407022 -0.004213361263266858503 0.01339996461731847964 0.052027273530243139943 0.24573891610939982422 0.030463041921829983605 0.044662581130978519506 -0.43384675995259913694 -0.15944633615751444;1.0289747173728516216 0.65372374073294425845 0.095902243830766925603 0.15914563038272686035 0.38064209095138368255 0.076228313160675520432 -0.11666941594436222585 0.00045443199498416964044 -0.19371440796316552468 -0.47629247516512157601 -0.23861368772126434479 0.0076770741236251022199 0.0062536265421901798822 -0.44588080649283212686 0.39206208557714000706 0.04336219898324048666 0.23160888443839985906 -0.14669054418316945787 0.22878598604450181564 0.034929607088067866905 0.26621220386804944624 -0.21534542212248505844 0.28795047540533330599 -0.028636897894927570984 -0.23746488949232852361 -0.188243376028567444 0.009623951380418466206 0.20796463440308571302 -0.029251376477509742624 0.12156483810373348853 0.052683864499014465554 0.08898731066313476934 0.1338618254975467714 -0.011884248611633160819 -0.2259116732011550166 0.038443683333931388812 -0.35376143032038265268 -0.87292880997343269556 -0.93636029586309155182 0.60716736901275880633;-0.27527362391152665477 0.28510080305864027306 -0.47884121709281912693 -0.16338570708235633511 -0.17593963169373627586 -0.12391124802322338316 -0.33398554605836455744 -0.10460914842416711712 -0.145547330654201168 -0.4266331035720540843 -0.27060105375686477336 -0.082648709033067105367 -0.017103835565888521331 0.025542494736401674671 0.37921033450059882242 -0.161314069463251053 0.031901764543537512731 -0.30437308796688050672 0.34131189303624626108 -0.022470752285790668995 -0.040152859324556408605 -0.37944216857690771239 -0.12285902578548139885 0.11116385671414880099 -0.169636820650165554 0.41407461893630520544 -0.33646758632166023917 0.27091805670413748874 0.30312073991630600345 0.29062460656001393167 0.012587066024338587622 0.0732904952733349907 0.30017467518419754802 0.29954766194127635526 -0.16503857171311539509 -0.28698175063708941668 -0.28974319278291388313 0.18039110623191173532 -0.027657641306877141923 0.18184753311378626384;-0.14399570330616298652 -0.36447667140663964069 0.024764494991917934685 -0.34624180375741209215 -0.075119204137933118237 0.026910066456295837767 0.38443681096388693241 0.37187924059974736268 -0.19713162995452790383 0.063516515687068064722 0.27058588705050123924 -0.25810590453277404421 0.2767214865887579478 0.34638352488261081596 0.12553679640334994283 -0.19360671977875359984 0.28673419260121463248 -0.35662971372627988442 -0.26457895575668222143 -0.34154826685221317817 0.18574983632038088999 0.24154395086098209844 -0.060850381599649158715 0.24949227659199585405 -0.0068449122426684477077 0.32747677128695901194 0.17434556994971220356 0.20294347108622257103 -0.072188763408828932056 -0.26721211930019389547 -0.1553220789943117186 0.29182228411940885904 0.35650863956216793937 -0.13392782788400328653 -0.16050309615256444506 0.037760357540477684779 -0.18934332884745408432 -0.13599396785557479883 0.19451711581823891151 0.34523395443127252724;0.14210486220032339522 -0.36444682232954456191 -0.17477716651484115351 -0.3207803511223359938 -0.35156999127882826439 -0.041057733271794169538 -0.075270020383821051313 -0.064585852830608386776 0.26732609645692834155 -0.21053643780082761938 -0.011610858959735586085 -0.10704251523680786973 0.3947959430624979893 -0.3446391433488774636 0.17196601458319346611 -0.32277461774049726051 0.11083918980345996985 0.15776977020743268576 -0.33297201032814888189 -0.38913202589006529175 -0.29620322216184474806 -0.37757822581395128481 -0.055484945314850347975 0.043426829902668141747 -0.21602920525660521123 0.086011339323901342402 0.12402375864786692461 -0.31679934030341866391 -0.17230854705375944769 0.25211889896496170183 0.048335750370032723455 0.27230056373355543409 0.19581863881920505421 0.044751309632270912242 0.35151048480851015965 -0.36354471566333929067 -0.27538487438809716723 0.13166557856443852903 -0.081091773991320684201 -0.19273953443481425807;-0.2586974860159256262 -0.087247626356704771622 -0.16686422042560611345 0.26036056575689320303 -0.32119720589895001117 -0.57213920386775396487 -0.022138466235718929492 0.059053031440880004999 -0.096455407321021660594 -0.10532314687439998935 0.23604822429882352242 0.34923890164293414085 -0.23969786392975445111 0.2073300904624545693 0.3936842053266230157 0.077153023992721225799 -0.347888414141673874 -0.37727787198996121099 0.42235649779058587194 0.14709833239152445006 -0.0088729849609871409843 -0.43540530046911340989 0.32764796804914664285 -0.022493897728155215487 0.52579376454667448026 -0.34847615465228759524 -0.19960485696828958457 0.21507953474809085592 0.3548017965586358069 -0.34872476225949194939 -0.41347406672603598254 0.23212806935949986675 0.16909116967151952005 0.30368044161556378979 0.34298677367046354059 0.070912760508185457287 0.24658550130275885826 0.29291951977561780929 0.037346583377110408042 -0.3408083896693683279;-0.020507784274842646294 0.071786472940650283836 0.033900717335018655529 -0.055144612035320991761 0.1894177110296572375 0.0078811796598823122967 0.2795783049474766524 -0.099943062744246219387 -0.31314717848715944992 -0.39485092562124868287 0.24840089251225341838 -0.45066912653172491732 0.20405446508678518058 -0.090199189093248421933 -0.12055524072572684768 -0.36840304166207887837 -0.36480256303186958666 -0.0072321031115400846029 -0.13263807422495882404 -0.40418458979890098393 -0.29844970618058985767 0.089697434969493394785 0.18359021816144494021 -0.08123101981215519185 -0.22989980470414703162 -0.31484322556148086614 0.12303940363814538927 -0.088433042356940549933 0.21257266101890828769 -0.044965877115665860153 -0.0030585475645790050764 -0.3189345810136518522 0.12254583330058871349 -0.39075262609934063862 -0.27300084989548478731 0.27708739018620187622 -0.3746317011227520144 0.22928221983258448291 -0.33828413976692545129 -0.45448328673416005241;-0.37354947025753054701 0.34929220836280322482 -0.047624021255575167688 0.27756423730083246149 0.091649147570869352042 0.11218201220744968005 0.1041300071801757321 -0.16465191347363142271 -0.19158910514386084945 -0.221852600271016831 0.14486103919050599687 0.36950964940231961764 -0.38282034498856870597 -0.13260472961169367245 0.32728374489254891122 0.21935290213150068772 -0.29379333532841489518 0.3668589772881387101 -0.30677129500484440205 -0.0052232831295115286774 0.24004758946773910311 -0.0040252105529378252868 0.29077696394410629255 0.12121889995638211734 0.15286607829233120337 -0.17507635546398120363 0.32746191264187218817 -0.34256536190587338897 -0.19894384507325638123 -0.2810605980796797021 -0.22497373529202116527 0.084405707191517978516 0.35196723634413074056 0.13507340832203582059 -0.30881658594623051517 -0.027437008374894305412 0.089301224313007437905 0.31890919134449446926 0.24362262984382482278 -0.035686294780090763168;-0.19639831035330224118 0.32728692731580466546 -0.023411196657170736668 0.077931802374429398617 0.098093358697621438336 0.047018074806369151986 -0.34060782493142610639 0.2820797781250857228 0.26658308461150725943 0.16013418052242847645 -0.48424870614455739481 -0.37077427200315116185 0.21449628457054040198 0.19321839840739354899 0.29089282918695597013 -0.40479827049074668111 0.21471811352877784307 -0.36056762995942182037 -0.2118381438557780938 0.21010083942884244523 -0.13242889740808772014 0.17470882865079390145 0.40283308763633884908 0.32187288580695988527 -0.11360971869402225476 0.045000911820506389605 -0.34942193496906998051 0.048795807038314271964 0.15923399314913808111 0.13725231033189450036 -0.073933354452308239213 -0.25042092879606603351 -0.29667717784986724627 0.20854234885216177409 0.14037183090182595024 -0.30672577178528209751 0.37910688826705224441 0.046014952672912182163 -0.066152635901393641582 0.085611619878518424587;-0.59911855821638404507 0.0071363010397748026514 0.04094530665081268922 0.047773137767203897874 -0.35122034523171297149 -0.2220404794717416308 -0.099529806034086842903 -0.024446466747565346461 0.014498660354321693533 0.41202447883410819873 -0.12027973514020057211 0.023933492336535758249 -0.15488090562935075134 0.35354268186554360653 -0.21295695024836291953 -0.40001238957633394877 -0.030690021953985565512 0.060058871477258551907 -0.15957940095012529413 0.0668128386100314553 -0.14380513911677528238 -0.38193494535573191406 0.16970030668451674405 0.43067546583630017532 0.067433369998847511595 0.24439738461057336494 0.44993284737480332414 0.28692651986368949979 0.22670923942909557147 -0.36679655655464615815 -0.27188067844969265874 -0.18278013945622867409 -0.044419599116162826469 0.29920110421417261959 -0.038714893340438760738 -0.28999973996677264054 0.072996523067578117372 0.21918440281398268721 0.30610042985278584915 0.0039495420809576662485;0.31988346219267022041 0.2300431929048956381 -0.17787836082226252121 -0.2901719669083369646 0.37548808614353818003 0.17733273312914404896 0.3647335468174024431 0.049775681541412236664 0.22384518449149937158 -0.27096449313176446116 0.024086446743135297294 -0.074305931527551480342 -0.16775959034293216887 0.12561320624634247922 -0.17972616458512824522 0.27328997363218215932 -0.13363879491041263936 -0.26239032167460657474 0.2036434003648781299 0.13351537631470350442 0.30577507755344207618 0.29656778380299458897 -0.31594757552086022434 0.2619264304187658432 -0.094517807516862145656 -0.36467094648606745988 0.1272041232181565229 -0.27836640475983931431 -0.082818963658872590816 0.34575262220004088221 0.3151800666872907053 -0.31094569034686364573 0.025222684212870279119 0.38213942956032292964 0.048861163374403396298 0.30250157647983411113 0.0025379000583986488157 0.17000718186732721726 -0.38557321352482681887 0.054386188392388269686;-0.53692998554275084278 0.35359944713594243515 -0.53605222920483519555 -0.30307818297598437818 -0.062942800667786139024 -0.44178038069960812173 -0.32850905856755591161 -0.22333673937607806392 0.12673952909489627494 -0.33807490908042936439 0.27214638478755293072 0.093484410165396950032 0.46545135946535332039 0.29257737164434238775 0.14834402830212012336 0.2979159197666392811 0.3770021399942543594 -0.35904908519953537827 -0.095149280414982412291 0.096504792400941577513 0.10793794106015835998 -0.2541957780123537125 -0.22814527536028367249 0.33393922858530700193 0.059359101120737778334 -0.063559922174152627683 -0.026630880543235375957 0.40713243281618199942 0.39772934547824095874 0.057255999977034781334 -0.22229281923352731121 0.14507589780613694419 -0.013112372368897860786 0.3462434551581192177 -0.31761474597010630472 0.41254022480168878184 -0.060105167909018174244 0.5602759035046006586 0.3733739495765858174 -0.50439198577556432213];

% Layer 2
b2 = [-0.037163743497417106587;-0.33853064091658191526];
LW2_1 = [0.14897790636806851339 0.69111208908055232758 0.23012913454342270869 -0.40091972474185405551 0.34770011087377078463 0.20314545291975921737 -0.038998449569019627559 -0.71695257771929155055 -0.2584177467012483409 -1.5863366134568630539 1.0754781252956666648 -0.043390562986206200613 -0.36770596484391171455 0.34388298451586807314 0.91476207087139027596 -0.10452350932039557174 -0.71138216268934939546 0.22841793194317910887 0.16269530124093720125 0.86712615377703583519;0.13610989710666254737 -0.93979316617127361955 0.81148968895422068925 0.49511246128160574242 -1.0585368200545914874 1.2525761380372895104 -1.3824621144655779847 0.54103013982587755404 0.18147104845798639472 0.8909075129077648203 0.61793707978884793164 -0.21287580692503141333 -0.79099142702125524451 -0.85229325018578161455 -0.071088693904620206543 -0.30322049493532121645 -0.1282078747390749951 -0.64642292727064964986 0.38491782254154904841 -0.94374343328089960181];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
